var requirejs,require,define;!function(aa){function I(a){return"[object Function]"===L.call(a)}function J(a){return"[object Array]"===L.call(a)}function y(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function M(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function s(a,b){return ga.call(a,b)}function m(a,b){return s(a,b)&&a[b]}function G(a,b){for(var c in a)if(s(a,c)&&b(a[c],c))break}function R(a,b,c,d){return b&&G(b,function(b,e){(c||!s(a,e))&&(d&&"string"!=typeof b?(a[e]||(a[e]={}),R(a[e],b,c,d)):a[e]=b)}),a}function u(a,b){return function(){return b.apply(a,arguments)}}function ba(a){if(!a)return a;var b=aa;return y(a.split("."),function(a){b=b[a]}),b}function B(a,b,c,d){return b=Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a),b.requireType=a,b.requireModules=d,c&&(b.originalError=c),b}function ha(a){function b(a,b,c){var d,e,f,g,h,i,j,k=b&&b.split("/");d=k;var l=C.map,n=l&&l["*"];if(a&&"."===a.charAt(0))if(b){for(d=m(C.pkgs,b)?k=[b]:k.slice(0,k.length-1),b=a=d.concat(a.split("/")),d=0;b[d];d+=1)if(e=b[d],"."===e)b.splice(d,1),d-=1;else if(".."===e){if(1===d&&(".."===b[2]||".."===b[0]))break;d>0&&(b.splice(d-1,2),d-=2)}d=m(C.pkgs,b=a[0]),a=a.join("/"),d&&a===b+"/"+d.main&&(a=b)}else 0===a.indexOf("./")&&(a=a.substring(2));if(c&&l&&(k||n)){for(b=a.split("/"),d=b.length;d>0;d-=1){if(f=b.slice(0,d).join("/"),k)for(e=k.length;e>0;e-=1)if((c=m(l,k.slice(0,e).join("/")))&&(c=m(c,f))){g=c,h=d;break}if(g)break;!i&&n&&m(n,f)&&(i=m(n,f),j=d)}!g&&i&&(g=i,h=j),g&&(b.splice(0,h,g),a=b.join("/"))}return a}function c(a){A&&y(document.getElementsByTagName("script"),function(b){return b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===w.contextName?(b.parentNode.removeChild(b),!0):void 0})}function d(a){var b=m(C.paths,a);return b&&J(b)&&1<b.length?(c(a),b.shift(),w.require.undef(a),w.require([a]),!0):void 0}function e(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function f(a,c,d,f){var g,h,i=null,j=c?c.name:null,k=a,l=!0,n="";return a||(l=!1,a="_@r"+(M+=1)),a=e(a),i=a[0],a=a[1],i&&(i=b(i,j,f),h=m(K,i)),a&&(i?n=h&&h.normalize?h.normalize(a,function(a){return b(a,j,f)}):b(a,j,f):(n=b(a,j,f),a=e(n),i=a[0],n=a[1],d=!0,g=w.nameToUrl(n))),d=!i||h||d?"":"_unnormalized"+(N+=1),{prefix:i,name:n,parentMap:c,unnormalized:!!d,url:g,originalName:k,isDefine:l,id:(i?i+"!"+n:n)+d}}function g(a){var b=a.id,c=m(D,b);return c||(c=D[b]=new w.Module(a)),c}function h(a,b,c){var d=a.id,e=m(D,d);!s(K,d)||e&&!e.defineEmitComplete?g(a).on(b,c):"defined"===b&&c(K[d])}function i(a,b){var c=a.requireModules,d=!1;b?b(a):(y(c,function(b){(b=m(D,b))&&(b.error=a,b.events.error&&(d=!0,b.emit("error",a)))}),d||l.onError(a))}function j(){T.length&&(ia.apply(H,[H.length-1,0].concat(T)),T=[])}function k(a){delete D[a],delete E[a]}function n(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,y(a.depMaps,function(d,e){var f=d.id,g=m(D,f);g&&!a.depMatched[e]&&!c[f]&&(m(b,f)?(a.defineDep(e,K[f]),a.check()):n(g,b,c))}),c[d]=!0)}function o(){var a,b,e,f,g=(e=1e3*C.waitSeconds)&&w.startTime+e<(new Date).getTime(),h=[],j=[],k=!1,l=!0;if(!t){if(t=!0,G(E,function(e){if(a=e.map,b=a.id,e.enabled&&(a.isDefine||j.push(e),!e.error))if(!e.inited&&g)d(b)?k=f=!0:(h.push(b),c(b));else if(!e.inited&&e.fetched&&a.isDefine&&(k=!0,!a.prefix))return l=!1}),g&&h.length)return e=B("timeout","Load timeout for modules: "+h,null,h),e.contextName=w.contextName,i(e);l&&y(j,function(a){n(a,{},{})}),g&&!f||!k||!A&&!da||z||(z=setTimeout(function(){z=0,o()},50)),t=!1}}function p(a){s(K,a[0])||g(f(a[0],null,!0)).init(a[1],a[2])}function q(a){var a=a.currentTarget||a.srcElement,b=w.onScriptLoad;return a.detachEvent&&!Y?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1),b=w.onScriptError,(!a.detachEvent||Y)&&a.removeEventListener("error",b,!1),{node:a,id:a&&a.getAttribute("data-requiremodule")}}function r(){var a;for(j();H.length;){if(a=H.shift(),null===a[0])return i(B("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));p(a)}}var t,v,w,x,z,C={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},D={},E={},F={},H=[],K={},L={},M=1,N=1;return x={require:function(a){return a.require?a.require:a.require=w.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?a.exports:a.exports=K[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return C.config&&m(C.config,a.map.id)||{}},exports:K[a.map.id]}}},v=function(a){this.events=m(F,a.id)||{},this.map=a,this.shim=m(C.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},v.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=u(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var a=this.map;if(!this.shim)return a.prefix?this.callPlugin():this.load();w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return a.prefix?this.callPlugin():this.load()}))}},load:function(){var a=this.map.url;L[a]||(L[a]=!0,w.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id;b=this.depExports;var d=this.exports,e=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,1>this.depCount&&!this.defined){if(I(e)){if(this.events.error)try{d=w.execCb(c,e,b,d)}catch(f){a=f}else d=w.execCb(c,e,b,d);if(this.map.isDefine&&((b=this.module)&&void 0!==b.exports&&b.exports!==this.exports?d=b.exports:void 0===d&&this.usingExports&&(d=this.exports)),a)return a.requireMap=this.map,a.requireModules=[this.map.id],a.requireType="define",i(this.error=a)}else d=e;this.exports=d,this.map.isDefine&&!this.ignore&&(K[c]=d,l.onResourceLoad)&&l.onResourceLoad(w,this.map,this.depMaps),k(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,c=a.id,d=f(a.prefix);this.depMaps.push(d),h(d,"defined",u(this,function(d){var e,j;j=this.map.name;var n=this.map.parentMap?this.map.parentMap.name:null,o=w.makeRequire(a.parentMap,{enableBuildCallback:!0});this.map.unnormalized?(d.normalize&&(j=d.normalize(j,function(a){return b(a,n,!0)})||""),d=f(a.prefix+"!"+j,this.map.parentMap),h(d,"defined",u(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),(j=m(D,d.id))&&(this.depMaps.push(d),this.events.error&&j.on("error",u(this,function(a){this.emit("error",a)})),j.enable())):(e=u(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=u(this,function(a){this.inited=!0,this.error=a,a.requireModules=[c],G(D,function(a){0===a.map.id.indexOf(c+"_unnormalized")&&k(a.map.id)}),i(a)}),e.fromText=u(this,function(b,d){var h=a.name,j=f(h),k=O;d&&(b=d),k&&(O=!1),g(j),s(C.config,c)&&(C.config[h]=C.config[c]);try{l.exec(b)}catch(m){return i(B("fromtexteval","fromText eval for "+c+" failed: "+m,m,[c]))}k&&(O=!0),this.depMaps.push(j),w.completeLoad(h),o([h],e)}),d.load(a.name,o,e,C))})),w.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){E[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,u(this,function(a,b){var c,d;if("string"==typeof a){if(a=f(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,c=m(x,a.id))return this.depExports[b]=c(this),void 0;this.depCount+=1,h(a,"defined",u(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&h(a,"error",this.errback)}c=a.id,d=D[c],!s(x,c)&&d&&!d.enabled&&w.enable(a,this)})),G(this.pluginMaps,u(this,function(a){var b=m(D,a.id);b&&!b.enabled&&w.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){y(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},w={config:C,contextName:a,registry:D,defined:K,urlFetched:L,defQueue:H,Module:v,makeModuleMap:f,nextTick:l.nextTick,onError:i,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=C.pkgs,c=C.shim,d={paths:!0,config:!0,map:!0};G(a,function(a,b){d[b]?"map"===b?(C.map||(C.map={}),R(C[b],a,!0,!0)):R(C[b],a,!0):C[b]=a}),a.shim&&(G(a.shim,function(a,b){J(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=w.makeShimExports(a)),c[b]=a}),C.shim=c),a.packages&&(y(a.packages,function(a){a="string"==typeof a?{name:a}:a,b[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(ja,"").replace(ea,"")}}),C.pkgs=b),G(D,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=f(b))}),(a.deps||a.callback)&&w.require(a.deps||[],a.callback)},makeShimExports:function(a){return function(){var b;return a.init&&(b=a.init.apply(aa,arguments)),b||a.exports&&ba(a.exports)}},makeRequire:function(c,d){function e(b,h,j){var k,m;return d.enableBuildCallback&&h&&I(h)&&(h.__requireJsBuild=!0),"string"==typeof b?I(h)?i(B("requireargs","Invalid require call"),j):c&&s(x,b)?x[b](D[c.id]):l.get?l.get(w,b,c,e):(k=f(b,c,!1,!0),k=k.id,s(K,k)?K[k]:i(B("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(c?"":". Use require([])")))):(r(),w.nextTick(function(){r(),m=g(f(null,c)),m.skipMap=d.skipMap,m.init(b,h,j,{enabled:!0}),o()}),e)}return d=d||{},R(e,{isBrowser:A,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0];return-1!==e&&("."!==f&&".."!==f||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),w.nameToUrl(b(a,c&&c.id,!0),d,!0)},defined:function(a){return s(K,f(a,c,!1,!0).id)},specified:function(a){return a=f(a,c,!1,!0).id,s(K,a)||s(D,a)}}),c||(e.undef=function(a){j();var b=f(a,c,!0),d=m(D,a);delete K[a],delete L[b.url],delete F[a],d&&(d.events.defined&&(F[a]=d.events),k(a))}),e},enable:function(a){m(D,a.id)&&g(a).enable()},completeLoad:function(a){var b,c,e=m(C.shim,a)||{},f=e.exports;for(j();H.length;){if(c=H.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);p(c)}if(c=m(D,a),!b&&!s(K,a)&&c&&!c.inited){if(C.enforceDefine&&(!f||!ba(f)))return d(a)?void 0:i(B("nodefine","No define call for "+a,null,[a]));p([a,e.deps||[],e.exportsFn])}o()},nameToUrl:function(a,b,c){var d,e,f,g,h,i;if(l.jsExtRegExp.test(a))g=a+(b||"");else{for(d=C.paths,e=C.pkgs,g=a.split("/"),h=g.length;h>0;h-=1){if(i=g.slice(0,h).join("/"),f=m(e,i),i=m(d,i)){J(i)&&(i=i[0]),g.splice(0,h,i);break}if(f){a=a===f.name?f.location+"/"+f.main:f.location,g.splice(0,h,a);break}}g=g.join("/"),g+=b||(/\?/.test(g)||c?"":".js"),g=("/"===g.charAt(0)||g.match(/^[\w\+\.\-]+:/)?"":C.baseUrl)+g}return C.urlArgs?g+((-1===g.indexOf("?")?"?":"&")+C.urlArgs):g},load:function(a,b){l.load(w,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){("load"===a.type||ka.test((a.currentTarget||a.srcElement).readyState))&&(P=null,a=q(a),w.completeLoad(a.id))},onScriptError:function(a){var b=q(a);return d(b.id)?void 0:i(B("scripterror","Script error",a,[b.id]))}},w.require=w.makeRequire(),w}var l,w,x,D,t,E,P,K,Q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,A=!("undefined"==typeof window||!navigator||!document),da=!A&&"undefined"!=typeof importScripts,ka=A&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,Y="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),F={},r={},T=[],O=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(I(requirejs))return;r=requirejs,requirejs=void 0}"undefined"!=typeof require&&!I(require)&&(r=require,require=void 0),l=requirejs=function(a,b,c,d){var e,f="_";return!J(a)&&"string"!=typeof a&&(e=a,J(b)?(a=b,b=c,c=d):a=[]),e&&e.context&&(f=e.context),(d=m(F,f))||(d=F[f]=l.s.newContext(f)),e&&d.configure(e),d.require(a,b,c)},l.config=function(a){return l(a)},l.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=l),l.version="2.1.5",l.jsExtRegExp=/^\/|:|\?|\.js$/,l.isBrowser=A,w=l.s={contexts:F,newContext:ha},l({}),y(["toUrl","undef","defined","specified"],function(a){l[a]=function(){var b=F._;return b.require[a].apply(b,arguments)}}),A&&(x=w.head=document.getElementsByTagName("head")[0],D=document.getElementsByTagName("base")[0])&&(x=w.head=D.parentNode),l.onError=function(a){throw a},l.load=function(a,b,c){var d,e=a&&a.config||{};if(A)return d=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),d.type=e.scriptType||"text/javascript",d.charset="utf-8",d.async=!0,d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&0>d.attachEvent.toString().indexOf("[native code")||Y?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(O=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,K=d,D?x.insertBefore(d,D):x.appendChild(d),K=null,d;if(da)try{importScripts(c),a.completeLoad(b)}catch(f){a.onError(B("importscripts","importScripts failed for "+b+" at "+c,f,[b]))}},A&&M(document.getElementsByTagName("script"),function(a){return x||(x=a.parentNode),(t=a.getAttribute("data-main"))?(r.baseUrl||(E=t.split("/"),Q=E.pop(),fa=E.length?E.join("/")+"/":"./",r.baseUrl=fa,t=Q),t=t.replace(ea,""),r.deps=r.deps?r.deps.concat(t):[t],!0):void 0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),J(b)||(c=b,b=[]),!b.length&&I(c)&&c.length&&(c.toString().replace(la,"").replace(ma,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b)),O&&((d=K)||(P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(a){return"interactive"===a.readyState?P=a:void 0}),d=P),d&&(a||(a=d.getAttribute("data-requiremodule")),e=F[d.getAttribute("data-requirecontext")])),(e?e.defQueue:T).push([a,b,c])},define.amd={jQuery:!0},l.exec=function(b){return eval(b)},l(r)}}(this),Refuel.config.modules={generic:{className:"GenericModule"},list:{className:"ListModule",elements:{template:{selector:"[data-rf-template]",strip:!0,onlyone:!0}}},sayt:{className:"SaytModule",elements:{inputField:{selector:"input"},resultList:{selector:"ul"},listItemTemplate:{selector:"ul > li"}}},scroller:{className:"ScrollerModule"}},function(){function a(a){a&&"load"===a.type&&(console.log(j.src,"loaded!"),a.target.parentNode.removeChild(a.target),b())}function b(){if(k){var a={baseUrl:"",paths:{}};a.baseUrl=Refuel.config.basePath;var b=[];k&&(a.paths[k]=location.pathname+l+"/"+k,b.push(k)),Refuel.config=Refuel.mix(a,Refuel.config),require.config(Refuel.config);for(var c in Refuel.config.libs)window[c]||b.push(Refuel.config.libs[c]);f?b.push(f):Refuel.config.modules||b.push("config.modules"),require(b,function(){try{Path.listen()}catch(a){}k&&d[k].body()})}}var c={basePath:"/",requireFilePath:"lib/require.min.js",libs:{Path:"lib/path.min.js",Hammer:"lib/hammer.min.js",polyfills:"lib/polyfills.min.js"},autoObserve:!0};window.Refuel=window.Refuel||{},Refuel.config=Refuel.config||c;var d={},e="_Refuel-default-start-class";Refuel.classMap=d,Refuel.mix=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},Refuel.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},Refuel.isUndefined=function(a){return"undefined"==typeof a},Refuel.getCookie=function(a){var b=null;if(document.cookie&&""!=document.cookie)for(var c=document.cookie.split(";"),d=0;d<c.length;d++){var e=c[d].trim();if(e.substring(0,a.length+1)==a+"="){b=decodeURIComponent(e.substring(a.length+1));break}}return b},Refuel.clone=function(a){if(null===a||"object"!=typeof a)return a;var b;try{b=a.constructor()}catch(c){return a}for(var d in a)b[d]=Refuel.clone(a[d]);return b},Refuel.refuelClass=function(a){var b=void 0;return a&&a._refuelClassName&&(b=a._refuelClassName),b},Refuel.resolveChain=function(a,b,c){var d=b,e=!1;if(a&&"."!=a&&""!=a){e=-1!=a.indexOf("!"),e&&(a=a.substr(e));for(var f,g,h=a.split("."),i=0;g=h[i];i++)for(f=d,void 0===d&&console.error(g,"in",a,"from",b,"is undefined"),d=d[g];"DataSource"==Refuel.refuelClass(d);)f=d,d=d.getData()}return e&&(d=!d),c?{value:d,parent:f}:d},Refuel.createInstance=function(a,b){var c=d[a];if("undefined"==typeof c)throw a+" not defined, please use Refuel.define";var e,f=c.body;if(b._refuelClassName||(b._refuelClassName=a),c.inherits){if(!d[c.inherits])throw c.inherits+" not defined, please use Refuel.define";f.prototype=Refuel.createInstance(c.inherits,b)}return e=new f(b),e._refuelClassName||(e._refuelClassName=b._refuelClassName,delete b._refuelClassName),e.hasOwnProperty("init")&&e.init(b),e},Refuel.newModule=function(a,b){return Refuel.createInstance(a,b)},Refuel.define=function(a,b,c){if(void 0!==d[a])throw new TypeError(a+" alredy defined!");void 0===c&&(c=b);var e=[];e=e.concat(b.require,b.inherits),e=e.filter(function(a){return void 0!==a?!0:!1});try{define(a,e,function(){d[a]={body:c,inherits:b.inherits}})}catch(f){console.log(f)}},Refuel.start=function(a,c){k=e,Refuel.define(e,a,c),b()},Refuel.static=function(a,b){Refuel[a]=b()};var f,g=document.querySelector("head"),h=g.querySelector("script[data-rf-startup]"),i=g.querySelector("script[data-rf-confmodules]"),j=document.createElement("script");if(i&&(f=i.getAttribute("data-rf-confmodules")),h){var k=h.getAttribute("data-rf-startup"),l=k.split("/");k=l[l.length-1],l=l.slice(0,l.length-1).join("/")||"."}"undefined"==typeof define?(j.type="text/javascript",j.charset="utf-8",j.async=!0,j.addEventListener("load",a,!1),j.src=Refuel.config.requireFilePath,g.appendChild(j)):b()}(),Refuel.static("ajax",function a(){function b(){var a;return a=window.XMLHttpRequest?new window.XMLHttpRequest:function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}throw new Error("This browser does not support XMLHttpRequest.")}}function c(b,c,f){b.onreadystatechange=null,b.abort(),d--,clearTimeout(e[c].timeoutId);var g={url:c,responseText:"",responseJSON:{}};if(f.retryTimes){var h=f.retryDelay;f.retryTimes-=1,f.retryDelay+=f.retryDelayIncrease,f.timeout+=f.retryTimeoutIncrease,setTimeout(function(){a(c,f)},h)}else e[c].counter=0,f[f.timeout?"timeoutCallback":"errorCallback"].call(f.callerModule,g,0,b),f._genericCallback(g,null,b,"timeout")}function a(a,h){h.headers=Refuel.mix(f.headers,h.headers),h=Refuel.mix(f,h);var i,j,k=b(),l=h.method?h.method:"GET";h.timeout=h.timeout||6e4,j=setTimeout(function(a,b,d){return function(){c(a,b,d)}}(k,a,h),h.timeout),e[a]={counter:e[a]?e[a].counter+1:1,timeoutId:j},k.onreadystatechange=function(){var b,c={};if(4===k.readyState){e[a].counter=0,clearTimeout(e[a].timeoutId),d--;try{b=k.status}catch(f){b=0}if(c={url:a,responseXML:k.responseXML,responseText:k.responseText},c.responseText)try{switch(h.mimeType){case"json":c.responseJSON=JSON.parse(c.responseText)||{}}}catch(f){console.error("Parsing Error in responseText",c),i="error"}var g=!1,i="timeout";h.allowedStatus&&(g=h.allowedStatus.indexOf(b)>-1?!0:!1),b>=200&&400>b||1224===b||g?i="success":b>=400&&(i="error"),h._genericCallback(c,b,k,i),"success"===i?h.successCallback.call(h.callerModule,c,b,k):"error"===i&&h.errorCallback.call(h.callerModule,c,b,k)}};var m=h.params,n=m?"?"+m:"",o=(new Date).getTime();g.last||(g.last=(new Date).getTime());var p=Math.max(20-(o-g.last),0);return setTimeout(function(){if(k.open(l,a+n),d++,i=h.headers)for(var b in i)i.hasOwnProperty(b)&&k.setRequestHeader(b,i[b]);k.send(l.match(/POST|PUT/)&&h.body?h.body:null),g.last=(new Date).getTime()},p),k}var d=0,e={},f={callerModule:this,mimeType:"json",headers:{"Content-Type":"application/json",Accept:"application/json; charset=utf-8"},_genericCallback:function(){return!0},successCallback:function(){},errorCallback:function(){},timeoutCallback:function(){}},g={};return{haveActiveConnections:function(){return d>0},get:function(b,c){return c=Refuel.mix(f,c),c.method="GET",a(b,c)},post:function(b,c,d){return d=Refuel.mix(f,d),d.method="POST",d.body=c,a(b,d)},put:function(b,c,d){return d=Refuel.mix(f,d),d.method="PUT",d.body=c,a(b,d)},"delete":function(b,c){return c=Refuel.mix(f,c),c.method="DELETE",a(b,c)}}}),Refuel.define("Events",function(){if(!this.notify||!this.subscribe){var a={};this.onGoingNotification=a,this.notify=function(b,c){if(!b||"string"!=typeof b)throw new TypeError("Invalid event name "+b);if(c=c||{},a[b]instanceof Array)for(var d,e=[].concat(a[b]),f=0;d=e[f];f++)d.callback.call(d.context,c)},this.subscribe=function(b,c,d){if(!b||"string"!=typeof b)throw new TypeError("Invalid event name "+b);if(!c||"function"!=typeof c)throw new TypeError("Invalid event callback "+c);d||(d=this),"undefined"==typeof a[b]?a[b]=[]:this.unsubscribe(b,c);var e={callback:c,context:d};a[b].push(e)},this.isSubscribed=function(b){return!(Refuel.isUndefined(a[b])||0===a[b].length)},this.unsubscribe=function(b,c){if(!b||"string"!=typeof b||c&&"function"!=typeof c)throw new TypeError("name is not defined or wrong callback");if(c){for(var d=0,e=a[b].length;e>d;d++)if(a[b][d].callback.toString()===c.toString())return a[b].splice(d,1),void 0}else delete a[b]}}}),Refuel.define("AbstractModule",{require:["Template","DataSource"],inherits:"Observer"},function(){function a(a){this.elements[a.name]=a.element}function b(a){var b=a.symbol,c=a.module,d=a.config,e=b.linkedTo.split("."),f=e.splice(0,1)[0];e=e.join("."),e&&g.datapath&&console.error(f,"error. dataPath defined twice");var h={autoload:!1,root:b.domElement,dataLabel:f,data:this.data[f],dataPath:e};d=Refuel.mix(h,d),d=Refuel.mix(d,g[f]);var i=Refuel.newModule(c.className,d);this.addModule(i)}function c(a){var b=f[a.linkedTo];if(b){var c=a.options?b.context.items[a.options]:b.context;a.module||(a.module=c),b.callback.call(c,a)}else this.notify("_unhandledAction",a)}function d(a){this.enableAutoUpdate(this.data);var b=a.linkedTo;this.observe(b,a.symbol,function(a,b){this.template.renderSymbol(b,this.data),this.notify("observableChange",{observable:a},!0)})}function e(){}var f={};this.items={};var g={dataPath:".",autoload:!1,autoObserve:!0};this.init=function(f){g=Refuel.mix(g,f),this.elements={},g.elements&&(this.elements=g.elements),this.defineUpdateManager(e.bind(this)),this.dataLabel=g.dataLabel,this.name=g.name,this.dataSource="DataSource"==Refuel.refuelClass(g.data)?g.data:Refuel.newModule("DataSource",g),g.data=null,this.template=Refuel.newModule("Template",g),this.template.subscribe("_new_module_requested",b,this),this.template.subscribe("_generic_binder_event",c,this),this.template.subscribe("_observe",d,this),this.template.subscribe("_template_element_found",a,this)},this.setDataPath=function(a){this.config.dataPath=a},this.addModule=function(a){a.parentModule=this,a.dataLabel?this.items[a.dataLabel]=a:this.items.push(a),a.subscribe("observableChange",function(a){this.notify("observableChange",a)},this),a.subscribe("_unhandledAction",function(b){b.module||(b.module=a),c.call(this,b)},this),this.dataSource.subscribe("dataAvailable",function(){a.dataLabel&&this.data[a.dataLabel]&&(a.data=this.data[a.dataLabel])},this)},this.getModulesByClass=function(a){var b=[];for(var c in this.items)Refuel.refuelClass(this.items[c])==a&&b.push(this.items[c]);return b},this.draw=function(a){a=a||this.data,this.template.render(a),this.notify("drawComplete")},this.defineUpdateManager=function(a){this.unsubscribe("_oa_update"),this.subscribe("_oa_update",a)},this.defineAction=function(a,b){f[a]={context:this,callback:b}},this.querySelector=function(a){return this.template.getRoot().querySelector(a)},this.toggleClass=function(a,b){void 0===b?this.classList.toggle(a):b?this.classList.add(a):this.classList.remove(a)},this.reload=function(){this.dataSource.reload()},this.saveData=function(){this.dataSource.save()},this.getModule=function(a){return this.items[a]},Object.defineProperty(this,"data",{configurable:!0,get:function(){return this.dataSource.getData()},set:function(a){this.dataSource.setData(a)}}),Object.defineProperty(this,"classList",{configurable:!0,get:function(){return this.template.getRoot().classList},set:function(){console.error("cannot set "+this+"classList")}}),Object.defineProperty(this,"root",{configurable:!0,get:function(){return this.template.getRoot()},set:function(){console.error("cannot set "+this+"classList")}})}),Refuel.define("ObservableArray",{inherits:"Events"},function(){function a(a){this[a]=function(){var d=e[a].apply(e,arguments);switch(a){case"push":var f=e.length-1;b.call(this,f),this.length=e.length;var g={action:"add",index:f,data:this[f]};this.notify("_oa_update",g);break;case"splice":var f=arguments[0];this.length=e.length,c.call(this,f);var g={action:"delete",index:f};this.notify("_oa_update",g)}return d}}function b(a){this.__lookupGetter__(a)||function(a,b){Object.defineProperty(a,b,{configurable:!0,set:function(c){a.setElementAt(b,c)},get:function(){return a.getElementAt(b)}})}(this,a)}function c(a){a&&delete this[a],d.call(this)}function d(){for(var a=0;a<e.length;a++)delete this[a],b.call(this,a)}this.config={};var e;this.init=function(b){this.config=Refuel.mix(this.config,b),this.set(this.config.value),["pop","push","reverse","shift","sort","splice","unshift","concat","slice"].forEach(a.bind(this))},this.__defineGetter__("data",function(){return e}),Object.defineProperty(this,"length",{configurable:!0,set:function(){var a={action:"update",data:e.length,prop:"length"};this.notify("_oa_update",a)},get:function(){return e.length}}),this.setElementAt=function(a,b){e[a]=b},this.getElementAt=function(a){return e[a]},this.filter=function(a){return e.filter(a)},this.clear=function(){for(var a=0;a<e.length;a++)delete this[a];e=[],e.length=0,this.length=0},this.set=function(){e=this.config.value,this.length=e.length,d.call(this),this.notify("_oa_update",{action:"set"})}}),Refuel.define("Observer",{require:["ObservableArray"],inherits:"Events"},function(){function a(e,f,g){if(e&&"."!=e){var h=e.split("."),i=h[h.length-1],j=Refuel.resolveChain(e,c,!0);f=j.value,g=j.parent}else g=this.dataSource;return"DataSource"==Refuel.refuelClass(g)&&(f=g.data,i="data"),f&&Refuel.isArray(f)?(g[i]=Refuel.createInstance("ObservableArray",{value:f}),a.call(this,e)):f&&"ObservableArray"==Refuel.refuelClass(f)?g[i].subscribe("_oa_update",function(a){a.observer=d[e],this.notify("_oa_update",a)},this):Object.defineProperty(g,i,{configurable:!0,set:function(a){d[e].value=a,b(d[e])},get:function(){return d[e].value}}),d[e]={name:e,value:f,owner:g},d[e]}function b(a){var b=a.callbackList;if(b&&b.length){b.length;for(var c,d=0;c=b[d];d++)c.callback.call(c.context,a,c.params)}}if(!this.observe){var c,d={};this.getObservers=function(){return d},this.clearObservers=function(){d={}},this.enableAutoUpdate=function(a){c=a},this.observe=function(b,e,f){if(f||(f=e,e=null),!c)return console.error("Before making",b,"observable you should enableAutoUpdate on",b,"or it's parent"),void 0;var g=d[b]&&d[b].callbackList?d[b].callbackList:[],h=a.call(this,b);return h.callbackList=g,d[b]=h,f&&h.callbackList.push({callback:f,context:this,params:e}),h}}}),Refuel.define("Template",{inherits:"Events"},function Template(){function parseDOMElement(a,b,c,d,e,f,g,h,i,j){f=a.attributes;for(var k={},l=0;h=f[l];l++)if(h.specified){i=h.name,j=h.value;var g=null,m=null;(g=i.match(c))?(m={action:g[1],attribute:h,attributeName:i,domElement:a,linkedTo:j,originalSymbol:j},"loop"===m.action&&(m.symbolTable=[])):(g=j.match(d))&&(m={action:"replaceAttributeValue",attribute:h,attributeName:i,domElement:a,linkedTo:g[1],originalSymbol:g[0]}),g&&(m.originalContent=j,m=splitOptions(m,m.linkedTo)),m&&(k[m.action]=m)}return k}function splitOptions(a,b){if(-1!=b.indexOf("?")&&-1!=b.indexOf(":")){b=b.replace(/\s+/g,"");var c=b.split("?");a.linkedTo=c[0],a.expression=b}else if(-1!=b.indexOf("&&"))a.expression=b;else if(-1!=b.indexOf("||"))a.expression=b;else{var c=b.split(":");a.linkedTo=c.length>1?c[1]:c[0],c.length>1&&(a.options=c[0])}return a.linkedTo=a.linkedTo.trim(),a.options&&(a.options=a.options.trim()),a.expression&&(a.expression=a.expression.trim()),a}function evalExpression(exp,data){exp=exp.replace(/\s+/g,"");var dataArr=exp.split(/\&\&|\|\||\=\=|\?|\:/),map={},solvedExpression="";if(dataArr.length>1){for(var i=0,key;key=dataArr[i];i++)key[0].match(/\'|\"/)||(map[key]=Refuel.resolveChain(key,data));solvedExpression=exp;for(var key in map)"string"==typeof map[key]&&(map[key]='"'+map[key]+'"'),solvedExpression=solvedExpression.replace(key,map[key]);return eval(solvedExpression)}}function normalizePath(a){return a=a.replace(config.dataLabel,""),"."==a.charAt(0)&&(a=a.substr(1)),a||"."}function hasDataAction(a,b){for(var c in a.dataset){var d=c.replace(datasetRegExp,"");if(d.toLowerCase()===b||""===d)return a}return!1}function notifyEvent(a){a.stopPropagation(),self.bindingsProxy=self.bindingsProxy||self;var b=hasDataAction(a.target,a.type)||hasDataAction(a.currentTarget,a.type);bindingTable[a.type]&&b&&(a.action="click"===a.type||"tap"===a.type?b.dataset.rfAction||b.dataset.rfActionClick:b.getAttribute(markupActionPrefix+a.type),a=splitOptions(a,a.action),self.bindingsProxy.notify("_generic_binder_event",a))}function templateBinder(a,b){self.bindingsProxy=self.bindingsProxy||self;for(var c,d=0;c=b[d];d++){if(c.domElement===root,0==c.action.indexOf("action")){c.domAction=!0;var e="data-rf-action"===c.attributeName?"click":c.attributeName.replace(attributeRegExp,"");if(!bindingTable[e]){var f;"undefined"!=typeof Hammer?f=Hammer(a).on(e,notifyEvent):a.addEventListener?a.addEventListener(e,notifyEvent,!1):el.attachEvent&&a.attachEvent("on"+e,notifyEvent),bindingTable[e]=!0}}var g=config.autoObserve&&Refuel.config.autoObserve,h=c.options&&"observe"===c.options;if(!c.domAction&&(h||g)){var i=normalizePath(c.linkedTo);self.notify("_observe",{linkedTo:i,symbol:c})}}templateBound=!0}function getModuleParts(a){var b=a.elements;this.parts=this.parts||{};for(var c in b){var d,e=b[c],f=e.selector,g=e.onlyone;if(d=config.elements&&config.elements[c]?config.elements[c]:root.querySelectorAll(f),f&&d.length){var h=this.parts[c]=d.length>1&&!g?d:d[0];e.strip&&root.removeChild(h),this.notify("_template_element_found",{name:c,element:h})}}}function createListElement(a,b){var c=b.template.cloneNode(!0),d=Refuel.newModule("Template",{root:c});return d.bindingsProxy=self,d.render(a),b.elements.push(d),d.getRoot()}function markMissing(a,b){self.markMissedRefs&&"undefined"==typeof b&&(a.domElement.style.border="1px solid red",console.warn("missing",a.linkedTo,typeof b))}var self=this,root,config={},profiler={},bindingTable={},symbolTable=[],templateBound=!1,refuelModules=Refuel.config.modules,defaultPartsConfig={strip:!1,required:!1};this.markMissedRefs=!1,this.bindingsProxy=null;var markupPrefix="data-rf-",markupActionPrefix="data-rf-action-",regExpToMatchName=new RegExp(markupPrefix+"([a-z-]*)"),regExpToMatchValue=new RegExp("\\{\\{(.*)\\}\\}"),attributeRegExp=new RegExp(markupActionPrefix,"i"),datasetRegExp=new RegExp("rfAction","i");this.init=function(a){config=Refuel.mix(config,a),root=config.root},this.parse=function(a,b,c){var a=a||root;if(!a)throw"No root defined";b=a.nodeValue;var d=a===root;switch(d&&config.styleClass&&root.classList.add(config.styleClass),a.nodeType){case 1:var e=parseDOMElement(a,symbolTable,regExpToMatchName,regExpToMatchValue),f=null;for(var g in refuelModules){var h=markupPrefix+g;if(a.hasAttribute(h))if(f=refuelModules[g],d){moduleTemplateConfig=f,getModuleParts.call(this,f);
for(var g in e)symbolTable.push(e[g])}else this.submodules=this.submodules||{},a.getAttribute(h),this.notify("_new_module_requested",{symbol:e[g],module:f,config:e})}if(e["data-rf-visibility"]&&(k.displayStyle=k.domElement.style.display),!f||d){for(var i,j=0;i=a.childNodes[j++];)this.parse(i,symbolTable);for(var g in e)symbolTable.push(e[g])}break;case 3:if(c=b.match(regExpToMatchValue)){var k={action:"replaceText",domElement:a.parentElement,textNode:a,originalContent:b,originalSymbol:c[0]};k=splitOptions(k,c[1]),symbolTable.push(k)}}return symbolTable},this.parseTemplate=function(){symbolTable=this.parse(),this.notify("parsingComplete",symbolTable)},this.render=function(a){profiler.timestart=(new Date).getTime(),a||console.error("Template::render data argument is null"),symbolTable.length||this.parseTemplate(),templateBinder(root,symbolTable),self.notify("_template_parsed",{symbolTable:symbolTable});for(var b,c=0;b=symbolTable[c];c++)self.renderSymbol(b,a);profiler.timestop=(new Date).getTime(),profiler.enabled&&console.log("Template.profiler[render]",root.id,profiler.timestop-profiler.timestart)},this.renderSymbol=function(a,b){if(!a.domAction&&"list"!==a.action){a.domElement===root;var c=normalizePath(a.linkedTo),d=Refuel.resolveChain(c,b);switch(a.expression&&(d=evalExpression(a.expression,b)),a.action){case"replaceText":markMissing(a,d),a.textNode.textContent=a.originalContent.replace(a.originalSymbol,d||"");break;case"replaceAttributeValue":switch(markMissing(a),a.attributeName){case"checked":case"selected":a.domElement[a.attributeName]=1==d;break;case"data-src":var e=a.originalContent.replace(a.originalSymbol,d||"");a.domElement.removeAttribute("data-src"),a.domElement.setAttribute("src",e);break;default:a.attribute.value=a.originalContent.replace(a.originalSymbol,d)}break;case"visibility":a.domElement.style.display=d?a.displayStyle:"none";break;case"loop":a.elements=[],a.domElement.innerHTML="";for(var f=document.createDocumentFragment(),g=0;g<d.length;g++){var h=createListElement(d[g],a);h.setAttribute(markupPrefix+id,g),f.appendChild(h)}a.domElement.appendChild(f)}}},this.create=function(a,b,c){root=b.cloneNode(!0),this.render(c),a.appendChild(root)},this.remove=function(){root.parentNode.removeChild(root)},this.clear=function(){root.innerHTML=""},this.getSymbolTable=function(){return symbolTable},this.getSymbolByAction=function(a){for(var b,c=0;b=symbolTable[c];c++)if(b.action===a)return b},this.setRoot=function(a){root=a},this.getRoot=function(){return root},this.getBindings=function(){return bindingTable}}),Refuel.define("DataSource",{inherits:"Events"},function(){function a(a){this.setLoadProgress(),"DataSource"==Refuel.refuelClass(a)&&(a=Refuel.resolveChain("data",a)),"new"===n.mode?i=a:"add"===n.mode&&(i=a.hasOwnProperty("length")&&i.concat?i.concat(a):Refuel.mix(i,a)),this.setConfig(),o.found=o.requested=o.completed=0;for(var c in i){var d=i[c];"DataSource"==Refuel.refuelClass(d)&&(o.found++,d.loadComplete?b.call(this):d.loadProgress&&d.loadComplete||(o.requested++,d.subscribe("dataAvailable",function(){o.completed++,b.call(this)},this),d.setConfig({autoload:n.autoload}),d.init()))}o.found||b.call(this)}function b(){this.loadProgress&&o.requested==o.completed&&(this.setLoadComplete(),this.notify("dataAvailable",{data:i}))}function c(a,b){return"ObservableArray"==Refuel.refuelClass(b)?b.data:b}function d(){}function e(){}function f(){}function g(b,c,d,e){switch(e){case"success":j=b.responseJSON;var f=Refuel.resolveChain(n.dataPath,b.responseJSON);a.call(this,f);break;case"error":this.setLoadIdle(),console.error("datasource error:",n),this.notify("dataError",i);break;case"timeout":this.setLoadIdle(),console.error("datasource Timed-Out:",n),this.notify("dataError",i)}}function h(){var a={},b=n.url,c=n.key;b?a={get:function(a,b){var c=Refuel.clone(n);b&&(c.successCallback=c.errorCallback=c.timeoutCallback=b),c.params=a,Refuel.ajax.get(n.url,c)},post:function(a,b){var c=Refuel.clone(n);b&&(c.successCallback=c.errorCallback=c.timeoutCallback=b),Refuel.ajax.post(n.url,a,c)},put:function(a){Refuel.ajax.put(b,a,n)},"delete":function(){Refuel.ajax.delete(b,n)}}:c&&(a={get:function(){return localStorage.getItem(c)},set:function(){localStorage.setItem(c,JSON.stringify(i))},remove:function(){localStorage.removeItem(c)}});for(var c in a)this[c]||(this[c]=a[c]);return a}var i={},j={},k=null,l="idle",m=null,n={callerModule:this,defaultDataType:"Object",dataPath:null,successCallback:d.bind(this),errorCallback:e.bind(this),timeoutCallback:f.bind(this),autoload:!1,_genericCallback:g.bind(this),mode:"new",timeout:1e3,retryTimeoutIncrease:1e3,retryTimes:4,retryDelay:500,retryDelayIncrease:2e3},o={requested:0,completed:0};this.setLoadComplete=function(){l="complete"},this.setLoadProgress=function(){l="progress"},this.setLoadIdle=function(){l="idle"},Object.defineProperty(this,"loadComplete",{get:function(){return"complete"==l}}),Object.defineProperty(this,"loadProgress",{get:function(){return"progress"==l}}),Object.defineProperty(this,"loadIdle",{get:function(){return"idle"==l}}),Object.defineProperty(this,"loadStatus",{get:function(){return l}}),Object.defineProperty(this,"sourceData",{get:function(){return j}}),Object.defineProperty(this,"data",{configurable:!0,get:function(){return i},set:function(a){i=a}}),this.init=function(b){n=Refuel.mix(n,b),h.call(this),this.loadComplete?this.notify("dataAvailable",{data:i}):n.data?(a.call(this,n.data),n.data=null):n.autoload&&this.load()},this.abort=function(){},this.clear=function(){},this.setConfig=function(a){n.params=null,n.mode="new",n=Refuel.mix(n,a||{}),k=n,h.call(this)},this.getConfig=function(){return n},this.setData=function(b){a.call(this,b)},this.getData=function(){return i},this.save=function(){n.key?localStorage.setItem(n.key,JSON.stringify(i,c)):n.url&&console.error("Ajax call not yet implemented");for(var a in i){var b=i[a];"DataSource"==Refuel.refuelClass(b)&&b.save()}},this.load=function(b){if(this.setConfig(b),!this.loadProgress){if(this.setLoadProgress(),n.key){var c=localStorage.getItem(n.key),d=JSON.parse(c);if(d){j=d;var e=Refuel.resolveChain(n.dataPath,d);a.call(this,e)}else{var f="Array"==n.defaultDataType?[]:{};a.call(this,f)}}else n.url&&(m=Refuel.ajax.get(n.url,n));for(var g in i){var h=i[g];"DataSource"==Refuel.refuelClass(h)&&(h.loadComplete||h.load())}}},this.abort=function(){m.abort()},this.reload=function(){this.load(k)}}),Refuel.define("GenericModule",{inherits:"AbstractModule"},function(){var a={};this.init=function(b){a=Refuel.mix(a,b),delete a.data,a.root&&(this.template.setRoot(a.root),this.template.parseTemplate()),this.dataSource&&(this.dataSource.subscribe("dataAvailable",function(){this.notify("loadComplete"),this.draw()},this),this.dataSource.init(a))}}),Refuel.define("ListModule",{inherits:"AbstractModule",require:"ListItemModule"},function(){function a(a){switch(a.action){case"set":b.call(this);break;case"add":e.call(this,{data:a.data,index:a.index}),g&&this.filterApply(g);break;case"delete":c.call(this,{index:a.index})}}function b(a){a=a||this.data,this.selectedIndex=-1,this.items=[],this.template.clear();for(var b,c=0;b=a[c];c++)e.call(this,{data:b,index:c})}function c(a){this.items[a.index].destroy(),this.items.splice(a.index,1)}function d(){var a=null;if(f.rowStyle){var b=this.items.length,c=0==b%2?0:1;a=1==f.rowStyle.length?f.rowStyle[0]:f.rowStyle[c]}return a}function e(a){var b=d.call(this);this.elements.template&&this.elements.template.removeAttribute("data-rf-template");var c=Refuel.newModule("ListItemModule",{parentRoot:f.root,template:this.elements.template,autoload:!1,styleClass:b,data:a.data});this.addModule(c)}var f={maxLength:0};this.items=[];var g=null;this.init=function(c){f=Refuel.mix(f,c),delete f.data,this.selectedIndex=-1,this.dataSource.setConfig({defaultDataType:"Array"}),this.defineUpdateManager(a.bind(this)),f.root&&this.template.setRoot(f.root),this.dataSource&&(this.dataSource.subscribe("dataAvailable",function(a){f.maxLength&&a.data.length>f.maxLength&&(this.data=a.data.slice(0,f.maxLength)),this.notify("loadComplete"),this.draw(),b.call(this)},this),this.dataSource.init(f))},this.haslistener=function(){return this.dataSource.isSubscribed("dataAvailable")},this.create=function(){this.enableAutoUpdate(this.dataSource.getData(),f.dataLabel)},this.add=function(a){this.dataSource.data.push(a)},this.selectChildAt=function(a,b){b=void 0===b?!0:b,b&&(this.selectedIndex>-1&&this.items[this.selectedIndex].deselect(),this.selectedIndex=a,this.items[a].select())},this.removeAt=function(a){this.data.splice(a,1)},this.removeByFilter=function(a){this.filterBy(a);for(var b,c=0;b=this.data[c];c++)this.removeAt(this.getItemIndex(b))},this.update=function(a){var b={};b[f.dataLabel]=a,this.dataSource.setData(b)},this.applyOnItems=function(a,b){for(var c,d=this.items,e=0;c=d[e];e++){var f=[].concat(b);f.unshift(c),a.apply(c,f)}},this.getItemIndex=function(a){for(var b,c=0;b=this.data[c];c++)if(b===a)return c;return null},this.filterBy=function(a){return this.data?this.data.filter(function(b){var c=!0;for(var d in a)c=c&&a[d]==Refuel.resolveChain(d,b);return c}):[]},this.filterApply=function(a){g=a;var c=this.filterBy(a);return b.call(this,c),c},this.filterClear=function(){g=null,b.call(this)}}),Refuel.define("ListItemModule",{inherits:"AbstractModule"},function(){var a={};this.init=function(b){a=Refuel.mix(a,b),delete a.data,this.enableAutoUpdate(this.data),this.isSelected=!1,this.dataSource&&(this.dataSource.subscribe("dataAvailable",function(){this.notify("loadComplete"),this.draw()},this),this.dataSource.init(a))},this.destroy=function(){this.template.remove(),delete this},this.draw=function(){if(!a.template)throw"No template found for ListItemModule";this.template.create(a.parentRoot,a.template,this.data),this.notify("drawComplete")},this.select=function(){this.classList.add("selected"),this.isSelected=!0},this.deselect=function(){this.classList.remove("selected"),this.isSelected=!1}}),Refuel.define("SaytModule",{inherits:"GenericModule",require:["ListModule"]},function(){function a(){var a=this;f=this.elements.inputField,g=this.elements.resultList,h=this.elements.listItemTemplate,f.addEventListener("keyup",b.bind(this)),f.addEventListener("blur",function(){a.hide()}),f.addEventListener("focus",function(){a.show()}),j.enableKeySelection&&f.addEventListener("keydown",function(a){if(i.items.length&&(40==a.keyCode||38==a.keyCode||13==a.keyCode)){switch(a.keyCode){case 38:i.selectedIndex>0?i.selectChildAt(i.selectedIndex-1):i.selectChildAt(i.items.length-1);break;case 40:i.selectedIndex<i.items.length-1?i.selectChildAt(i.selectedIndex+1):i.selectChildAt(0);break;case 13:j.enterDefaultAction&&(a.preventDefault(),a.stopPropagation(),a.module=i.items[i.selectedIndex],j.enterDefaultAction.call(this,a))}j.keySelectionInsideInput&&i.selectedIndex&&(f.value=i.items[i.selectedIndex].data[j.primaryField])}}),i=this.getModulesByClass("ListModule")[0],i||(i=Refuel.newModule("ListModule",{root:g,dataLabel:"list",elements:{template:h}}),this.addModule(i)),this.hide(),i.template.parseTemplate()}function b(a){if(40!=a.keyCode&&38!=a.keyCode&&13!=a.keyCode){var b=f.value.trim();b!=this.currentQuery?(e&&window.clearTimeout(e),e=window.setTimeout(c.bind(this,b),j.delay)):this.show()}}function c(a){e&&window.clearTimeout(e),d=this.currentQuery,0===a.length?this.hide():a.length>=j.minChars&&(this.currentQuery=a,i.template.clear(),this.dataSource.load({params:j.searchParam+"="+a}))}var d,e,f,g,h,i,j={minChars:2,searchParam:"q",delay:100,primaryField:"name",enableKeySelection:!0,keySelectionInsideInput:!0,enterDefaultAction:null};this.init=function(b){j=Refuel.mix(j,b),delete j.data,j.root&&this.template.setRoot(j.root),this.template.subscribe("parsingComplete",a,this),this.template.parseTemplate(),this.dataSource&&(this.dataSource.subscribe("dataAvailable",function(){this.notify("loadComplete"),this.draw()},this),this.dataSource.init(j)),this.currentQuery=null},this.draw=function(a){a=a||this.data,this.template.render(a),i.data=a,a.length?this.show():this.hide(),this.notify("drawComplete")},this.hide=function(){i.toggleClass("hide",!0)},this.show=function(){i.toggleClass("hide",!1)}}),Refuel.define("ScrollerModule",{inherits:"Events"},function(){function a(a){switch(a.type){case"touchstart":e.call(t,a);break;case"touchmove":f.call(t,a);break;case"touchend":h.call(t,a);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"transitionend":c.call(t,a);break;case"resize":case"DOMSubtreeModified":case"DOMNodeInserted":case"DOMNodeRemoved":case"DOMNodeRemovedFromDocument":case"DOMNodeInsertedIntoDocument":case"DOMAttrModified":case"DOMCharacterDataModified":d.call(t,a)}}function b(){n&&(n.style.height=Math.floor(p*p/o)+"px",p>=o)||s&&(n||(n=document.createElement("div"),r&&0!=o&&(n.style.height=Math.floor(p*p/o)+"px"),n.style.width="5px",n.style.position="absolute",n.style.top="0px",n.style.right="5px",n.style.background="black",n.style.border="1px solid white",n.style.opacity="0.5",n.style.borderRadius="5px",n.style.display="none",n.style.zIndex=1,s.appendChild(n)))}function c(){var a=r.offsetHeight-s.offsetHeight,b=-a;x>0||0>a?i():Math.abs(x)>=Math.abs(a)?j(b):n&&(n.style.display="none"),this.notify("transitionEnd")}function d(){o=r.getBoundingClientRect().height,p=s.getBoundingClientRect().height-E.topMargin,n&&b()}function e(a){y=a.touches[0].pageY,C=[];var b=Math.ceil(r.getBoundingClientRect().top-s.getBoundingClientRect().top);g(r,"transform","translate3d(0,"+b+"px,0)"),g(r,"transition","0ms linear"),g(r,"transition","none"),x=b,w=b,z=Number(new Date),u=0,a.stopPropagation()}function f(a){n&&(n.style.display="block"),a.touches.length>1||a.scale&&1!==a.scale||(a.preventDefault(),u=a.touches[0].pageY-y,x=w+u,Math.abs(v)>=Math.abs(u)&&(z=Number(new Date),y=a.touches[0].pageY,w=x),v=u,g(r,"transform","translate3d(0,"+x+"px,0)"),l(x),C.push(x))}function g(a,b,c){var d=Modernizr.prefixed(b);a.style[d]=c}function h(a){q=Number(new Date),A=q-z;var b=u/A,c=Math.abs(u);B=Math.abs(C[C.length-1]-C[C.length-2]),b>=8?b=4:"",-8>b?b=-4:"";var d,e=r.offsetHeight-s.offsetHeight,f=-e,h=Math.floor(E.maxElong%(100*Math.abs(b)))+50;if(B>3&&c>10)if(x+=Math.ceil(b*E.speed/2),x>0)g(r,"transform","translate3d(0,"+h+"px,0)"),g(r,"transition",h+"ms linear"),m(h),i(),d="upperBoundReached";else if(Math.abs(x)>=Math.abs(e)){var k="translate3d(0,"+-(e+h)+"px,0)";g(r,"transform",k),g(r,"transition",h+"ms linear"),m(-(e+h)),j(),d="lowerBoundReached"}else moveTo(x),m(x),d="movedTo";else{if(x>0||0>e)return i(),a.stopPropagation(),void 0;if(Math.abs(x)>=Math.abs(e))return j(f),a.stopPropagation(),void 0;n&&(n.style.display="none")}v=0,w=x,a.stopPropagation(),d&&this.notify(d,{y:w})}function i(){g(r,"transform","translate3d(0,0,0)");var a=E.inertia+"ms cubic-bezier(0, 0, 0, 1)";g(r,"transition",a),n&&(m(0),setTimeout(function(){n.style.display="none"},E.inertia)),w=0}function j(){var a=-o+p,b="translate3d(0,"+a+"px,0)";g(r,"transform",b),b=E.inertia+"ms cubic-bezier(0, 0, 0, 1)",g(r,"transition",b),n&&(m(a),setTimeout(function(){n.style.display="none"},E.inertia)),w=a}function k(){return s=E.rootDOMElement,!s&&E.rootId&&(s=document.querySelector("#"+E.rootId)),s?(r=s.children[0])?(s.style.overflow="hidden",r.style.width="100%",r.style.position="absolute",r.style.margin=0,r.style.listStyle="none",r.style.MozTransform=r.style.webkitTransform="translate3d(0,0,0)",r.style.MozTransitionDuration=r.style.webkitTransitionDuration=0,void 0):(this.error("scroll pane not specified"),void 0):(this.error("rootDOMElement not specified"),void 0)}function l(a){if(n){var b=p/o,c=-1*Math.floor(a*b);g(n,"transform","translate3d(0,"+c+"px,0)")}}function m(a){if(n){var b=p/o,c=-1*Math.floor(a*b);g(n,"transform","translate3d(0,"+c+"px,0)"),g(n,"transition",E.speed+"ms cubic-bezier(0, 0, 0, 1)")}}var n,o,p,q,r,s,t=this,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=!1,C=[],D=["touchstart","touchmove","touchend","webkitTransitionEnd","msTransitionEnd","oTransitionEnd","transitionend","DOMSubtreeModified","DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMAttrModified","DOMCharacterDataModified"],E={startScroll:0,speed:1e3,inertia:300,maxElong:150,scrollBar:!1,topMargin:0};this.init=function(b){E=Refuel.mix(E,b),s=E.rootDOMElement,!s&&E.rootId&&(s=document.querySelector("#"+E.rootId)),k(),d(),D.forEach(function(b){r.addEventListener(b,a,!1)}),window.addEventListener("resize",a,!1)},this.moveTo=function(a,b){x=a,g(r,"transform","translate3d(0,"+x+"px,0)");var c=b||E.speed+"ms cubic-bezier(0, 0, 0, 1)";g(r,"transition",c)},this.reset=function(a){E=Refuel.mix(E,a),k(),m(0),u=0},this.destroy=function(){D.forEach(function(b){r.removeEventListener(b,a,!1)}),window.removeEventListener("resize",a,!1),n&&n.parentElement.removeChild(n)},this.setup=function(){window.scroll(0,0),c.call(this)}});